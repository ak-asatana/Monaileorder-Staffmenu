<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<title>スプレッドシート連動チェックボックス</title>
<style>
  body { font-family: sans-serif; text-align: center; margin-top: 50px; }
  .status { margin-top: 10px; }
</style>
</head>
<body>

<h2>スプレッドシートと同期するチェックボックス</h2>

<label>
  <input type="checkbox" id="syncCheckbox"> 有効にする
</label>

<p class="status" id="statusText">状態を読み込み中...</p>

<script>
// --- 設定：スプレッドシート側のWebアプリURLを指定 ---
const SCRIPT_URL = 'https://script.google.com/macros/s/AKfycbwF-B1wJ9J1l6bnzqi9OSM1g49xobExHQwjIImfk5vU0BlObtaBY_FvW32H2JKp0-qs/exec';
const checkbox = document.getElementById('syncCheckbox');
const statusText = document.getElementById('statusText');

/**
 * ページ読み込み時に現在の状態を取得
 */
window.addEventListener('load', async () => {
  try {
    const res = await fetch(SCRIPT_URL);
    const data = await res.json();
    const isChecked = data.value == 1;
    checkbox.checked = isChecked;
    statusText.textContent = `現在の状態：${isChecked ? 'ON (1)' : 'OFF (0)'}`;
  } catch (e) {
    statusText.textContent = '読み込みエラー';
  }
});

/**
 * チェックON/OFF変更時にスプレッドシートへ送信
 */
checkbox.addEventListener('change', async () => {
  const value = checkbox.checked ? 1 : 0;
  statusText.textContent = '更新中...';

  try {
    const res = await fetch(SCRIPT_URL, {
      method: 'POST',
      body: JSON.stringify({ value }),
      headers: { 'Content-Type': 'application/json' }
    });
    const data = await res.json();
    statusText.textContent = `更新しました：${data.value}`;
  } catch (e) {
    statusText.textContent = '送信エラー';
  }
});
</script>

</body>
</html>

